---
import MainLayout from '../layouts/MainLayout.astro';
import '../styles/global.css';

import type { MarkdownInstance } from 'astro';
import type { Frontmatter } from '../frontmatter';
import PostCard from '../components/PostCard.astro';

// Blog posts
const posts = Object.values(import.meta.glob<MarkdownInstance<Frontmatter>>('./posts/*.md', { eager: true }))
	.sort((a, b) => new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime())
---

<MainLayout pageTitle="James Harris">
	<div class="mx-auto w-fit px-4 relative">
		<hr class="border border-sky-700 absolute top-15 left-7 right-4 hidden sm:block" />
		<div class="grid grid-cols-1 sm:grid-cols-[minmax(200px,300px)_auto] gap-5 max-w-3xl">
			<h1 class="text-4xl mt-4">James Harris</h1>
			<h2 class="text-2xl mt-4 flex-col justify-end hidden sm:flex">Blog posts</h2>
			<div class="flex flex-col min-w-0 perspective-container">
				<a href="/periodic" class="animate-flutter left">
					<img src="/img/ptos-preview.png" alt="Periodic Table of Storytelling" class="mb-2 max-w-full rounded" />
					<!-- <h2 class="text-2xl underline">Periodic Table of Storytelling</h2> -->
				</a>
				<section class="mt-2 mb-4 bg-emerald-100 border border-emerald-500 text-emerald-950 px-3 py-2 rounded animate-flutter left" style="animation-delay: .15s">
					<h2 class="text-2xl font-bold">Guides</h2>
					<ul>
						<li><a href="">ğŸ’¾ Cheap, effortless backups</a></li>
						<li><a href="">ğŸ” File syncing</a></li>
						<li><a href="">ğŸ” Password vault</a></li>
						<li><a href="">ğŸª Blocking cookie banners</a></li>
					</ul>
				</section>
				<section class="mb-4 bg-indigo-100 border border-indigo-500 text-indigo-950 px-3 py-2 rounded animate-flutter left" style="animation-delay: .30s">
					<h2 class="text-2xl font-bold">Tools</h2>
					<ul>
						<li><a href="">ğŸ–¼ï¸ Batch vision</a></li>
						<li><a href="">ğŸ‘¥ Name generator</a></li>
						<li><a href="">ğŸ¨ VSCode Theme</a></li>
					</ul>
				</section>
				<section class="mb-4 bg-purple-100 border border-purple-500 text-purple-950 px-3 py-2 rounded animate-flutter left" style="animation-delay: .45s">
					<h2 class="text-2xl font-bold">Blogroll</h2>
					<ul>
						<li><a href="https://simonwillison.net/">
							<img class="w-4 h-4 inline-block" src="https://simonwillison.net/favicon.ico" alt=""/>
							Simon Willison
						</a></li>
						<li><a href="https://ncase.me/">
							<img class="w-4 h-4 inline-block" src="https://ncase.me/favicon.png" alt=""/>
							Nicky Case</a></li>
						<li><a href="https://www.astralcodexten.com/">
							<img class="w-4 h-4 inline-block" src="https://www.astralcodexten.com/favicon.ico" alt=""/>
							Scott Alexander
						</a></li>
					</ul>
				</section>
			</div>
			<section class="flex flex-col min-w-64" >
				<h2 class="text-2xl mb-4 sm:hidden">Blog posts</h2>
				<ul class="perspective-container"> 
					{ posts.map((post, index) => (
						<li class="animate-flutter right" style={`animation-delay: ${index * 0.15}s`}>
							<a href={post.url}>
								<PostCard post={post}/>
							</a>
						</li>
					))}
				</ul>
			</section>
		</div>
	</div>
</MainLayout>

<style>
    .perspective-container {
        perspective: 1000px;
    }

    .animate-flutter {
        animation-name: flutter;
        animation-duration: 1.2s;
        animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
        animation-iteration-count: 1;
        transform-style: preserve-3d;
        will-change: transform;
    }
	.animate-flutter.left {
        transform-origin: right center;
		--dir: 1;
	}
	.animate-flutter.right {
        transform-origin: left center;
		--dir: -1;
	}

	@media (prefers-reduced-motion: reduce) {
		.animate-flutter {
			animation: none;
			transform: none;
		}
	}

    @keyframes flutter {
        /* The "Dampened Spring" Effect:
           It gets pushed out, snaps back, wobbles slightly, then rests.
        */
        0% {
            transform: rotateY(0deg);
        }
        25% {
            /* The Gust: Pushes the card out */
            /* 8deg * -1 becomes -8deg (Butterfly effect) */
            transform: rotateY(calc(8deg * var(--dir, 1)));
        }
        50% {
            /* The Snap Back: Tension pulls it back, slightly overshooting neutral */
			transform: rotateY(calc(-3deg * var(--dir, 1)));
		}
        75% {
            /* The Residual Wobble: Little bit of energy left */
			transform: rotateY(calc(3deg * var(--dir, 1)));
		}
        100% {
            /* Settle */
            transform: rotateY(0deg);
        }
    }
</style>